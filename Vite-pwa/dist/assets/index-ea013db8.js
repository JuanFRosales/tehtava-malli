(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const b={pwaInDevEnvironment:!1,webManifest:{href:"./manifest.webmanifest",useCredentials:!1,linkTag:'<link rel="manifest" href="./manifest.webmanifest">'}},u=async(e,t={})=>{const n=await fetch(e,t);if(!n.ok)throw new Error(`Error ${n.status} occured`);return n.json()},l="https://student-restaurants.azurewebsites.net/api/v1",D="https://student-restaurants.azurewebsites.net/uploads/";console.log(b);const f=document.querySelector("#login-form"),m=document.querySelector("#profile-form"),p=document.querySelector("#avatar-form"),g=document.querySelector("#username"),h=document.querySelector("#password"),c=document.querySelector("#profile-username"),i=document.querySelector("#profile-email"),s=document.querySelector("#avatar"),w=document.querySelector("#username-target"),v=document.querySelector("#email-target"),S=document.querySelector("#avatar-target"),T=async e=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return await u(l+"/auth/login",t)},q=async(e,t)=>{const n=new FormData;n.append("avatar",e);const a={method:"POST",headers:{Authorization:"Bearer "+t},body:n};return await u(l+"/users/avatar",a)},I=async(e,t)=>{const n={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(e)};return await u(l+"/users",n)},y=e=>{!w||!v||!S||!i||!c||(w.innerHTML=e.username,v.innerHTML=e.email,S.src=D+e.avatar,i.value=e.email,c.value=e.username)},L=async e=>{const t={headers:{Authorization:"Bearer "+e}};return await u(l+"/users/token",t)},O=async()=>{const e=localStorage.getItem("token");if(!e)return;const t=await L(e);await y(t)};O();f==null||f.addEventListener("submit",async e=>{if(e.preventDefault(),!g||!h)return;const t={username:g.value,password:h.value},n=await T(t);console.log(n),localStorage.setItem("token",n.token),y(n.data)});m==null||m.addEventListener("submit",async e=>{if(e.preventDefault(),!c||!i)return;const t=localStorage.getItem("token");if(!t)return;const n={username:c.value,email:i.value},a=await I(n,t);console.log(a),await y(a.data)});p==null||p.addEventListener("submit",async e=>{if(e.preventDefault(),!(s!=null&&s.files))return;const t=s.files[0],n=localStorage.getItem("token");if(!n)return;const a=await q(t,n);console.log(a)});
